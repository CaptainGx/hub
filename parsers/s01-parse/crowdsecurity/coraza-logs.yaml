onsuccess: next_stage
#debug: true
filter: "evt.Parsed.program == 'waf'"
name: crowdsecurity/coraza-logs
description: "Parse Coraza Events"
statics:
  - parsed: coraza_parsed
    expression: UnmarshalJSON(evt.Line.Raw, evt.Unmarshaled, 'waf')
  - meta: req_uuid
    expression: evt.Unmarshaled.waf.req_uuid
  - meta: source_ip
    expression: evt.Unmarshaled.waf.source_ip
  - meta: rule_id
    expression: evt.Unmarshaled.waf.rule_id
  - meta: action
    expression: evt.Unmarshaled.waf.rule_action
  - meta: service
    value: waf
  - parsed: event_type
    value: waf_match
