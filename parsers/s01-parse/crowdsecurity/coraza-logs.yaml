onsuccess: next_stage
debug: true
filter: "evt.Parsed.program == 'coraza-waf'"
name: crowdsecurity/coraza-logs
description: "Parse Coraza Events"
statics:
  - meta: source_ip
    expression: evt.Parsed.source_ip
  - target: evt.StrTime
    expression: TimeNow()
  - meta: service
    value: http
#let's copy standard http fields too
  - parsed: event_type
    value: waf_match
  - parsed: verb
    expression: evt.Parsed.method
  - meta: http_status
    expression: evt.Parsed.http_status
  - meta: http_path
    expression: evt.Parsed.target_uri
  - meta: http_user_agent
    expression: evt.Parsed.http_user_agent
  - meta: target_fqdn
    expression: evt.Parsed.target_host
