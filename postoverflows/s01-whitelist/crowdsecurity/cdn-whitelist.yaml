name: crowdsecurity/cdn-whitelist
description: "Whitelist CDN providers"
whitelist:
  reason: "CDN provider"
  expression: 
    - "any(File('crowdsecurity/cloudflare_ips.txt'),{ IpInRange(evt.Overflow.Alert.Source.IP ,#)})"
    - "any(File('crowdsecurity/fastly_ips.txt'),{ IpInRange(evt.Overflow.Alert.Source.IP ,#)})"
data:
  - source_url: https://www.cloudflare.com/ips-v4
    dest_file: crowdsecurity/cloudflare_ips.txt
    type: string
  - source_url: https://api.fastly.com/public-ip-list
    dest_file: crowdsecurity/fastly_ips.txt
    type: string